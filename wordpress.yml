---

- name: Test ping
  hosts: VM
  become: yes
  tasks:
    - name: ping
      ping:
    # PHP
    - name: Install pre-requisite for PHP 7
      yum:
        name: "{{ packages }}"
        state: latest
      vars:
        packages:
        - epel-release
        - yum-utils
        - http://rpms.remirepo.net/enterprise/remi-release-7.rpm
    - name: Enable remi-php73 repository
      shell: yum-config-manager --enable remi-php73
    - name: Install PHP 7
      yum:
        name: "{{ packages }}"
        state: latest
      vars:
        packages:
        - php
        - php-common
        - php-opcache
        - php-mcrypt
        - php-cli
        - php-gd
        - php-curl
        - php-mysql
    # MySQL
    - name: Install mysql-server
      yum:
        name: "{{ packages }}"
        state: latest
      vars:
        packages:
        - https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm
    - name: Enable mysql repository
      shell: yum-config-manager --enable mysql80-community-release-el7-1
    - name: Install mysql-server
      yum:
        name: "{{ packages }}"
        state: latest
      vars:
        packages:
        - mysql-server
